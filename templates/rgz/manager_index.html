{% extends "rgz/base.html" %}
{% block title %}–ì–ª–∞–≤–Ω–∞—è - –ú–µ–Ω–µ–¥–∂–µ—Ä{% endblock %}
{% block content %}
<h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ session.user_full_name }}!</h2>
<p>–í–∞—à–∞ —Ä–æ–ª—å: <strong>–ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–Ω–∫–∞</strong></p>

<div id="statistics" style="margin: 30px 0;">
    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–Ω–∫–∞</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
        <div style="background: #e3f2fd; padding: 20px; border-radius: 5px; text-align: center;">
            <h4 id="totalUsers">0</h4>
            <p>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
        </div>
        <div style="background: #e8f5e9; padding: 20px; border-radius: 5px; text-align: center;">
            <h4 id="totalClients">0</h4>
            <p>–ö–ª–∏–µ–Ω—Ç–æ–≤</p>
        </div>
        <div style="background: #fff3e0; padding: 20px; border-radius: 5px; text-align: center;">
            <h4 id="totalManagers">0</h4>
            <p>–ú–µ–Ω–µ–¥–∂–µ—Ä–æ–≤</p>
        </div>
        <div style="background: #f3e5f5; padding: 20px; border-radius: 5px; text-align: center;">
            <h4 id="totalBalance">0</h4>
            <p>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å (—Ä—É–±.)</p>
        </div>
    </div>
</div>

<div class="quick-actions" style="margin-top: 30px;">
    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–∫–æ–º</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
        <a href="/rgz/users" style="background: #28a745; color: white; padding: 20px; border-radius: 5px; text-decoration: none; text-align: center;">
            <div style="font-size: 2em;">üë•</div>
            <h4>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h4>
            <p>–ü—Ä–æ—Å–º–æ—Ç—Ä, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ</p>
        </a>
        <a href="/rgz/create_user" style="background: #007bff; color: white; padding: 20px; border-radius: 5px; text-decoration: none; text-align: center;">
            <div style="font-size: 2em;">‚ûï</div>
            <h4>–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h4>
            <p>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞</p>
        </a>
        <a href="/rgz/history" style="background: #6c757d; color: white; padding: 20px; border-radius: 5px; text-decoration: none; text-align: center;">
            <div style="font-size: 2em;">üìã</div>
            <h4>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h4>
            <p>–í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–∞–Ω–∫–∞</p>
        </a>
        <a href="/rgz/statistics" style="background: #17a2b8; color: white; padding: 20px; border-radius: 5px; text-decoration: none; text-align: center;">
            <div style="font-size: 2em;">üìä</div>
            <h4>–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
            <p>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</p>
        </a>
    </div>
</div>

<script>
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    async function loadStatistics() {
        try {
            const result = await apiCall('/rgz/api/statistics');
            if (result.statistics) {
                document.getElementById('totalUsers').textContent = result.statistics.total_users;
                document.getElementById('totalClients').textContent = result.statistics.total_clients;
                document.getElementById('totalManagers').textContent = result.statistics.total_managers;
                document.getElementById('totalBalance').textContent = result.statistics.total_balance.toFixed(2);
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
        }
    }
    
    document.addEventListener('DOMContentLoaded', loadStatistics);
</script>
{% endblock %}